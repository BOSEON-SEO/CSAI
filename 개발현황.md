# 개발 현황 - CS AI 에이전트 프로젝트

**프로젝트명**: 투비네트웍스 글로벌 FAQ 자동 응답 시스템  
**생성일**: 2025-09-30  
**최종 업데이트**: 2025-10-01 15:30  
**버전**: 1.3

---

## 📋 목차

1. [프로젝트 개요](#프로젝트-개요)
2. [기술 스택 선정](#기술-스택-선정)
3. [프로젝트 구조](#프로젝트-구조)
4. [개발 계획 및 Work Phase](#개발-계획-및-work-phase)
5. [문서 구조 및 업데이트 계획](#문서-구조-및-업데이트-계획)
6. [현재 작업 상태](#현재-작업-상태)

---

## 프로젝트 개요

### 목표
CS 사원의 수동 FAQ 응대를 AI 기반 자동 응답 시스템으로 전환

### 핵심 구조
```
[FAQ 수집] → [AI 에이전트 분석] → [답변 생성] 
  → [CS 검수] → [판매 채널 등록]
```

### 기대 효과
| 지표 | 현재 | 목표 | 개선 |
|------|------|------|------|
| 응답 시간 | 2시간 | 30분 | 75% ↓ |
| 처리량 | 30건/일 | 300건/일 | 10배 ↑ |
| CS 작업 | 100% | 20% | 80% ↓ |

---

## 기술 스택 선정

### 선정된 기술 스택

#### AI/ML
- **질문 분석**: Sentence-BERT + spaCy (15-20ms, GPU 가속)
- **벡터 검색**: Weaviate 1.25 (하이브리드 검색, 50ms)
- **답변 생성**: Claude Sonnet 4 (2500ms)

#### 데이터베이스
- **관계형 DB**: MySQL 8.0 (네이버 API 원본 데이터 저장)
- **벡터 DB**: Weaviate (오픈소스, 셀프호스팅, $0)
- **NoSQL**: MongoDB 7.0 (FAQ 데이터, 가변 스키마, $0)
- **캐시**: Redis 7.2 ($0)

#### 백엔드
- **Framework**: FastAPI 0.115
- **Language**: Python 3.11.9
- **ASGI Server**: Uvicorn

#### 하드웨어
- **GPU**: NVIDIA GeForce RTX 3050 (CUDA 12.6)
- **RAM**: 64GB
- **CPU**: AMD Ryzen 5 9600 (6-Core, 3.80 GHz)

---

## 프로젝트 구조

```
C:\workspace\CSAI\
├── backend/
│   ├── app/
│   │   ├── models/
│   │   │   ├── __init__.py
│   │   │   ├── naver_api.py          ✅ NEW (2025-10-01)
│   │   │   └── database.py           ✅ NEW (2025-10-01)
│   │   └── services/
│   │       ├── __init__.py
│   │       └── naver_api_service.py  ✅ NEW (2025-10-01)
│   ├── venv/                         # Python 가상환경
│   └── requirements.txt
│
├── scripts/
│   └── faq/                          ✅ NEW (2025-10-01)
│       ├── export_mysql_to_sheet.py
│       └── import_sheet_to_mongodb.py
│
├── docs/
│   ├── 01_프로젝트_개요.md
│   ├── 02_시스템_아키텍처.md
│   ├── 03_기술스택_질문분석.md
│   ├── 04_기술스택_벡터DB.md
│   ├── 05_기술스택_NoSQL.md
│   ├── 09_개발_계획.md
│   ├── 11_FAQ_데이터_파이프라인.md   ✅ NEW (2025-10-01)
│   └── presentation/
│       └── 기술팀_공유_15분.md
│
├── docker/
│   └── docker-compose.yml           # Weaviate, MongoDB, Redis
│
├── config/                           # 설정 파일 (gitignore)
│   ├── .env.example
│   └── google_credentials.json.example
│
├── 개발현황.md                       ✅ UPDATED (2025-10-01)
└── README.md
```

---

## 개발 계획 및 Work Phase

### 전체 일정 (9주)

```
Phase 0: 요구사항 & 설계  [====✅====] 2025-09-23 ~ 09-30 (1주) 완료
         프로젝트 구조화   [====✅====] 2025-09-30 (당일) 완료
         FAQ 파이프라인    [====✅====] 2025-10-01 (당일) 완료
Phase 1: 인프라 구축      [====✅====] 2025-10-01 (당일) 완료
Phase 2: 데이터 준비      [=========] 2025-10-14 ~ 10-20 (1주)
Phase 3: AI 코어 개발     [==================] 2025-10-21 ~ 11-03 (2주)
Phase 4: CS UI 개발       [==================] 2025-11-04 ~ 11-17 (2주)
Phase 5: 통합 테스트      [=========] 2025-11-18 ~ 11-24 (1주)
Phase 6: 프로덕션 배포    [==================] 2025-11-25 ~ 12-06 (2주)

범례: ✅ 완료  [ ] 예정  [X] 진행 중
```

### 마일스톤

| 마일스톤 | 날짜 | 주요 산출물 | 상태 |
|----------|------|-------------|------|
| M0: 설계 완료 | 2025-09-30 | 아키텍처 문서, 기술 스택 선정, 프로젝트 구조 | ✅ 완료 |
| M0.5: FAQ 파이프라인 설계 | 2025-10-01 | 네이버 API 연동, MySQL/MongoDB 스키마, 데이터 변환 스크립트 | ✅ 완료 |
| M1: 개발 환경 준비 | 2025-10-01 | Docker 환경, Python 환경, GPU 활성화 | ✅ 완료 |
| M2: 데이터 준비 완료 | 2025-10-20 | MongoDB/Weaviate 초기 데이터 | 📅 예정 |
| M3: AI 코어 완성 | 2025-11-03 | FastAPI 백엔드, 모든 API | 📅 예정 |
| M4: UI 개발 완료 | 2025-11-17 | Next.js 프론트엔드 | 📅 예정 |
| M5: 테스트 완료 | 2025-11-24 | 테스트 보고서, 버그 수정 | 📅 예정 |
| M6: 프로덕션 배포 | 2025-12-06 | 운영 시스템 가동 | 📅 예정 |

---

## 현재 작업 상태

### Phase 진행률

| Phase | 상태 | 진행률 | 기간 |
|-------|------|--------|------|
| Phase 0: 설계 | ✅ 완료 | 100% | 2025-09-23 ~ 09-30 |
| **프로젝트 구조 초기화** | **✅ 완료** | **100%** | **2025-09-30** |
| **FAQ 데이터 파이프라인** | **✅ 완료** | **100%** | **2025-10-01** |
| **Phase 1: 인프라** | **✅ 완료** | **100%** | **2025-10-01** |
| Phase 2: 데이터 | 📅 예정 | 0% | 2025-10-14 ~ 10-20 |
| Phase 3: AI 코어 | 📅 예정 | 0% | 2025-10-21 ~ 11-03 |
| Phase 4: UI | 📅 예정 | 0% | 2025-11-04 ~ 11-17 |
| Phase 5: 테스트 | 📅 예정 | 0% | 2025-11-18 ~ 11-24 |
| Phase 6: 배포 | 📅 예정 | 0% | 2025-11-25 ~ 12-06 |

**전체 진행률**: 28% (Phase 0 + 구조 초기화 + FAQ 파이프라인 + Phase 1 완료)

---

### FAQ 데이터 파이프라인 완료 내역 (2025-10-01 오후)

#### ✅ 1. 네이버 Commerce API 모델 및 서비스
- **Pydantic 모델** (`backend/app/models/naver_api.py`)
  - `InquiryContent`: 개별 문의 상세 정보
  - `PageableInfo`, `SortInfo`: 페이징 정보
  - `NaverInquiryResponse`: 전체 API 응답 구조
  - 유틸리티 메서드: `get_unanswered_inquiries()`, `get_product_inquiries()`

- **SQLAlchemy ORM 모델** (`backend/app/models/database.py`)
  - `CustomerInquiry`: 고객 문의 원본 데이터 테이블 (MySQL)
  - `InquiryProcessingLog`: 문의 처리 과정 추적 로그
  - 처리 상태 추적: pending → exported_to_sheet → cs_reviewed → synced_to_mongo

- **API 서비스** (`backend/app/services/naver_api_service.py`)
  - `NaverCommerceAPIService`: 네이버 API 호출 및 데이터 저장
  - OAuth2 인증 자동 처리
  - 페이징 자동 순회 (최대 200개/페이지)
  - 중복 방지 upsert 로직
  - 폴링 방식 데이터 수집 (10분 간격 권장)

#### ✅ 2. 데이터 변환 스크립트
- **MySQL → Google Sheets** (`scripts/faq/export_mysql_to_sheet.py`)
  - pending 상태 문의를 Google Sheets로 자동 내보내기
  - CS 팀 검수를 위한 워크시트 자동 생성
  - 헤더 서식 자동 적용 (굵게, 배경색)
  - 처리 상태 자동 업데이트 (exported_to_sheet)

- **Google Sheets → MongoDB** (`scripts/faq/import_sheet_to_mongodb.py`)
  - CS 팀 검수 완료 데이터를 MongoDB FAQ 형식으로 변환
  - 제품 ID 자동 추출 (정규표현식 + MongoDB 제품명 매칭)
  - 키워드 자동 추출 (배터리, 블루투스, 충전 등)
  - FAQ 문서 구조 자동 생성 (질문, 답변, 관련 제품, 메타데이터)
  - MySQL 상태 자동 업데이트 (synced_to_mongo)
  - Upsert 방식으로 중복 방지

#### ✅ 3. 핵심 문서 작성
- **FAQ 데이터 파이프라인 전체 설계** (`docs/11_FAQ_데이터_파이프라인.md`)
  - 전체 아키텍처 다이어그램
  - 데이터 흐름 6단계 상세 설명
  - MySQL 및 MongoDB 스키마 설계
  - 스크립트 사용법 및 파라미터 가이드
  - CS 팀 작업 가이드 (Google Sheets 사용법)
  - 제약사항 및 해결방안 (실시간 알림 미지원 → 폴링 방식)
  - 운영 가이드 (모니터링, 백업, 장애 복구)
  - FAQ 및 문제 해결 섹션
  - 향후 확장 계획 (Phase 2-6)

#### ✅ 4. 데이터 파이프라인 특징

**워크플로우 설계 원칙:**
- **원본 데이터 보존**: MySQL에 네이버 API 원본을 그대로 저장
- **인간 중심**: CS 팀이 익숙한 Google Sheets 활용
- **단계별 추적**: processing_status로 각 문의의 현재 단계 명확히 관리
- **점진적 자동화**: 초기엔 수동 검수, 추후 AI 자동화로 확장

**처리 상태 흐름:**
```
pending (MySQL 저장) 
  ↓
exported_to_sheet (Google Sheets 내보냄)
  ↓
cs_reviewed (CS 팀 검수 완료)
  ↓
synced_to_mongo (MongoDB FAQ 저장)
  ↓
[AI 에이전트 사용 가능]
```

**주요 제약사항 및 해결:**
- ⚠️ **네이버 API 실시간 알림 없음**
  - 해결: 10분마다 폴링 방식으로 새 문의 수집
  - API Rate Limit 준수하며 최근 문의만 필터링
  - 최대 365일까지만 조회 가능 (네이버 API 제한)

- ⚠️ **Google Sheets를 중간 단계로 사용**
  - 이유: CS 팀 친숙도, 협업 용이성, 보안, 유연성
  - 향후: Phase 4-5에서 전용 웹 UI로 대체 예정

---

### Phase 1 완료 내역 (2025-10-01 오전)

#### ✅ 1. WSL 2 설치 및 활성화
- WSL 버전 2.6.1.0 설치 완료
- 커널 버전 6.6.87.2-1
- VirtualMachinePlatform 활성화
- 시스템 재부팅 완료

#### ✅ 2. Docker Desktop 설치 및 서비스 실행
- Docker Desktop 설치 완료
- WSL 2 백엔드 활성화
- docker-compose.yml을 통한 서비스 실행
  - **Weaviate 1.25.5**: http://localhost:8080 (정상 작동 확인)
  - **MongoDB 7.0**: http://localhost:27017 (정상 작동 확인)
  - **Redis 7.2**: http://localhost:6379 (백그라운드 실행 중)
  - **Mongo Express**: http://localhost:8081 (정상 작동 확인)

#### ✅ 3. Python 가상환경 구성
- Python 3.11.9 설치 확인
- 가상환경 생성 및 활성화
- requirements.txt 모든 패키지 설치 완료
- spaCy 한국어 모델 (ko_core_news_lg) 다운로드 완료

#### ✅ 4. GPU 환경 설정
- NVIDIA 드라이버 560.94 확인
- CUDA 12.6 지원 확인
- PyTorch 2.4.1 CUDA 12.1 버전 설치
- **GPU 인식 성공**: NVIDIA GeForce RTX 3050
- torch.cuda.is_available() = True

#### ✅ 5. 패키지 호환성 해결
- weaviate-client 버전 충돌 해결 (4.7.1 → 4.17.0)
- httpx 0.27.2와 완벽한 호환성 확인
- 모든 패키지 import 테스트 통과

---

## Phase별 체크리스트

### Phase 0: 요구사항 & 설계 ✅ 완료
- [x] 요구사항 분석
- [x] 시스템 아키텍처 설계
- [x] 기술 스택 선정
- [x] 프로젝트 구조 설계
- [x] 핵심 문서 작성
- [x] 프로젝트 구조 초기화
- [x] 스켈레톤 코드 작성
- [x] 설정 파일 작성

### FAQ 파이프라인 추가 체크리스트 ✅ 완료 (2025-10-01)
- [x] 네이버 Commerce API Pydantic 모델 작성
- [x] MySQL 데이터베이스 스키마 설계 (CustomerInquiry, InquiryProcessingLog)
- [x] MongoDB FAQ 컬렉션 스키마 설계
- [x] NaverCommerceAPIService 구현 (OAuth2, 페이징, upsert)
- [x] MySQL → Google Sheets 내보내기 스크립트
- [x] Google Sheets → MongoDB 임포트 스크립트
- [x] FAQ 데이터 파이프라인 전체 문서 작성
- [x] CS 팀 작업 가이드 작성
- [x] 운영 및 모니터링 가이드 작성

### Phase 1: 인프라 구축 ✅ 완료 (2025-10-01)
- [x] Python 3.11.9 가상환경 구성
- [x] Docker Desktop 설치 및 실행
- [x] Weaviate 컨테이너 정상 기동
- [x] MongoDB 컨테이너 정상 기동
- [x] Redis 컨테이너 정상 기동
- [x] GPU 인식 확인 (RTX 3050, CUDA 12.6)
- [x] 모든 Python 라이브러리 설치 및 테스트
- [x] 패키지 버전 호환성 확인 및 해결

### Phase 2: 데이터 준비 (2025-10-14 ~ 10-20) 📅 다음 단계
- [ ] 제품 스펙 데이터 작성 (10개)
  - Keychron 제품 위주 (K10 PRO, Q1, V6 등)
  - products_keychron.csv 파일 참조
- [ ] 초기 FAQ 데이터 작성 (50개)
  - 카테고리별 분류 (제품 문의, 기술 지원, 주문, 호환성, 기타)
  - 실제 네이버 스마트스토어 문의 참조
- [ ] MongoDB products 컬렉션에 제품 데이터 임포트
- [ ] FAQ 임베딩 생성 (Sentence-BERT)
- [ ] Weaviate 벡터 업로드
- [ ] 데이터 검증 및 테스트

---

## 생성된 파일 목록 (2025-10-01)

### Backend 모델 및 서비스
```
backend/
├── app/
│   ├── models/
│   │   ├── naver_api.py          # 네이버 API Pydantic 모델
│   │   └── database.py           # SQLAlchemy ORM 모델 (MySQL)
│   └── services/
│       └── naver_api_service.py  # 네이버 API 서비스 클래스
```

### 데이터 파이프라인 스크립트
```
scripts/
└── faq/
    ├── export_mysql_to_sheet.py       # MySQL → Google Sheets
    └── import_sheet_to_mongodb.py     # Google Sheets → MongoDB
```

### 문서
```
docs/
└── 11_FAQ_데이터_파이프라인.md        # 전체 파이프라인 설계 문서
```

---

## 다음 작업 (Phase 2)

### Phase 2 시작 전 준비사항
1. **네이버 Commerce API 인증 정보 확보**
   - Client ID 및 Client Secret 발급
   - `.env` 파일에 저장

2. **Google Service Account 설정**
   - Google Cloud Console에서 Service Account 생성
   - JSON 키 다운로드 → `config/google_credentials.json`
   - Google Sheets API 활성화
   - 스프레드시트 공유 (Service Account 이메일)

3. **Claude API 키 발급**
   - https://console.anthropic.com/settings/keys
   - `.env` 파일에 저장

4. **MySQL 데이터베이스 생성**
   ```sql
   CREATE DATABASE csai CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
   ```

5. **CS 팀과 일정 조율**
   - FAQ 데이터 수집 방법 논의
   - Google Sheets 사용법 교육 일정

### Phase 2 주요 작업 (2025-10-14 시작 예정)
1. **제품 스펙 데이터 작성** (10개)
   - 제품 코드, 이름, 카테고리
   - 스펙, 가격, 재고
   - 호환성, 펌웨어 버전

2. **FAQ 데이터 작성** (50개)
   - 카테고리별 분류 (제품 문의, 기술 지원, 주문, 호환성, 기타)
   - 질문-답변 쌍
   - 키워드, 복잡도

3. **MongoDB 스키마 설계**
   - products, faqs, customers, logs 컬렉션
   - 인덱스 설계

4. **데이터 임포트**
   - 스크립트 실행
   - 데이터 검증

5. **FAQ 임베딩 생성**
   - Sentence-BERT로 임베딩
   - Weaviate 업로드

---

## 빠른 참조

### Docker 서비스 포트 ✅ 모두 정상 작동
- **Weaviate**: http://localhost:8080
- **MongoDB**: http://localhost:27017
- **Redis**: http://localhost:6379
- **Mongo Express**: http://localhost:8081 (MongoDB GUI)

### 주요 명령어

#### Docker 서비스 관리
```bash
# 서비스 시작
cd C:\workspace\CSAI\docker
docker-compose up -d

# 서비스 상태 확인
docker-compose ps

# 로그 확인
docker-compose logs -f weaviate
docker-compose logs -f mongodb

# 서비스 중지
docker-compose down
```

#### Python 가상환경
```bash
# 가상환경 활성화 (Windows)
cd C:\workspace\CSAI\backend
venv\Scripts\activate

# 패키지 설치
pip install -r requirements.txt

# spaCy 한국어 모델 다운로드
python -m spacy download ko_core_news_lg

# GPU 확인
python -c "import torch; print('CUDA:', torch.cuda.is_available())"
```

---

## 프로젝트 통계

### 개발 환경
- **OS**: Windows 11 Pro 64bit
- **Python**: 3.11.9
- **Docker**: Desktop (WSL 2 백엔드)
- **GPU**: NVIDIA GeForce RTX 3050 (CUDA 12.6)

### 설치된 주요 패키지
- FastAPI 0.115.0
- PyTorch 2.4.1 (CUDA 12.1)
- Weaviate Client 4.17.0
- Anthropic 0.34.2
- spaCy 3.7.6 + ko_core_news_lg
- Sentence-Transformers 3.1.1
- SQLAlchemy 2.0+
- PyMySQL
- PyMongo
- Google API Python Client

### 실행 중인 Docker 서비스
- Weaviate 1.25.5
- MongoDB 7.0
- Redis 7.2-alpine
- Mongo Express 1.0-20

---

**문서 버전**: 1.3  
**관리자**: 개발팀  
**최종 업데이트**: 2025-10-01 15:30  
**다음 업데이트**: Phase 2 시작 시 (2025-10-14 예정)
