# 07. ë°ì´í„° ëª¨ë¸ ì„¤ê³„

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ì‘ì„±ì¼**: 2025-10-01  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-01 22:30  
**ì‘ì„±ì**: Claude  
**ìƒíƒœ**: âœ… Phase 2 ì™„ë£Œ

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [MySQL ìŠ¤í‚¤ë§ˆ](#mysql-ìŠ¤í‚¤ë§ˆ)
3. [MongoDB ìŠ¤í‚¤ë§ˆ](#mongodb-ìŠ¤í‚¤ë§ˆ)
4. [Weaviate í´ë˜ìŠ¤](#weaviate-í´ë˜ìŠ¤)
5. [ì¸ë±ìŠ¤ ì „ëµ](#ì¸ë±ìŠ¤-ì „ëµ)
6. [ë°ì´í„° íë¦„](#ë°ì´í„°-íë¦„)

---

## ê°œìš”

### ë°ì´í„°ë² ì´ìŠ¤ë³„ ì—­í• 

- **MySQL**: ë„¤ì´ë²„ Commerce API ì›ë³¸ ë°ì´í„° ì €ì¥ (Spring Boot)
- **MongoDB**: AI ì—ì´ì „íŠ¸ìš© ì œí’ˆ/FAQ ë°ì´í„° (Python FastAPI)
- **Weaviate**: FAQ ì˜ë¯¸ì  ë²¡í„° ê²€ìƒ‰ (Sentence-BERT ì„ë² ë”©)

### ì™„ë£Œëœ ì‘ì—… (Phase 2)

- âœ… MySQL customer_inquiry í…Œì´ë¸” ì„¤ê³„ ë° ë°ì´í„° 100ê±´ ìˆ˜ì§‘
- âœ… MongoDB ìŠ¤í‚¤ë§ˆ ì„¤ê³„ (products, faqs, customers, logs)
- âœ… Keychron ì œí’ˆ 160ê°œ JSON ë³€í™˜ ì™„ë£Œ
- âœ… Weaviate FAQ í´ë˜ìŠ¤ ì„¤ê³„

---

## MySQL ìŠ¤í‚¤ë§ˆ

### customer_inquiry í…Œì´ë¸”

```sql
-- 2025-10-01, Claude ì‘ì„±
-- ë„¤ì´ë²„ Commerce API ê³ ê° ë¬¸ì˜ ì›ë³¸ ë°ì´í„°
CREATE TABLE customer_inquiry (
    inquiry_no BIGINT PRIMARY KEY,
    category VARCHAR(20),
    title VARCHAR(500),
    inquiry_content TEXT,
    inquiry_registration_date_time DATETIME,
    answered BOOLEAN DEFAULT FALSE,
    answer_content TEXT,
    order_id VARCHAR(100),
    product_no VARCHAR(100),
    product_name VARCHAR(500),
    customer_id VARCHAR(100),
    customer_name VARCHAR(100),
    processing_status ENUM('pending', 'exported_to_sheet', 'cs_reviewed', 'synced_to_mongo'),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_status (processing_status),
    INDEX idx_category (category)
) ENGINE=InnoDB CHARSET=utf8mb4;
```

**ì²˜ë¦¬ ìƒíƒœ íë¦„**:
1. `pending` â†’ ë„¤ì´ë²„ APIì—ì„œ ìˆ˜ì§‘
2. `exported_to_sheet` â†’ Google Sheets ë‚´ë³´ë‚´ê¸°
3. `cs_reviewed` â†’ CS íŒ€ ê²€ìˆ˜ ì™„ë£Œ
4. `synced_to_mongo` â†’ MongoDB ë™ê¸°í™” ì™„ë£Œ

---

## MongoDB ìŠ¤í‚¤ë§ˆ

### products ì»¬ë ‰ì…˜ (160ê°œ ì œí’ˆ ì¤€ë¹„ ì™„ë£Œ)

```javascript
// 2025-10-01 22:30, Claude ì‘ì„±
{
  _id: ObjectId("..."),
  product_id: "KB-K10-PRO-001",
  product_name: "K10 Pro",
  product_name_synonyms: ["K10Pro", "K10 í”„ë¡œ"],
  price: 159000,
  discontinued: false,
  release_date: "2024-03-15",
  
  // í‚¤ë³´ë“œ ì‚¬ì–‘ (38ê°œ ì»¬ëŸ¼ í¬í•¨)
  keyboard_layout: "í’€ë°°ì—´",
  keyboard_type: "ê¸°ê³„ì‹",
  switch_options: ["Gateron Brown", "Red", "Blue"],
  connection_method: "ìœ ì„ /ë¬´ì„ /ë¸”ë£¨íˆ¬ìŠ¤",
  battery_capacity: "4000mAh",
  hot_swap_socket: true,
  
  // ì„ë² ë”©ìš© í…ìŠ¤íŠ¸
  description_text: "K10 ProëŠ”...",
  
  // ë©”íƒ€ë°ì´í„°
  created_at: ISODate("2025-10-01T22:00:00Z"),
  updated_at: ISODate("2025-10-01T22:00:00Z")
}
```

**ì¸ë±ìŠ¤**:
```javascript
db.products.createIndex({ product_id: 1 }, { unique: true })
db.products.createIndex({ product_name: 1 })
db.products.createIndex({ category: 1 })
db.products.createIndex({ discontinued: 1 })
```

### faqs ì»¬ë ‰ì…˜

```javascript
// 2025-10-01 22:30, Claude ì‘ì„±
{
  _id: ObjectId("..."),
  faq_id: "FAQ-001",
  
  // ì§ˆë¬¸/ë‹µë³€
  question: "K10 ProëŠ” Macì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œê°€ìš”?",
  answer: "ë„¤, Mac/Windows ëª¨ë‘ í˜¸í™˜ë©ë‹ˆë‹¤...",
  
  // ê´€ë ¨ ì •ë³´
  related_products: ["KB-K10-PRO-001", "KB-K10-PRO-002"],
  category: "í˜¸í™˜ì„±",
  keywords: ["Mac", "í˜¸í™˜ì„±", "K10 Pro"],
  complexity_score: 0.3,  // 0.0~1.0
  
  // í†µê³„
  view_count: 150,
  helpful_count: 48,
  
  // ë©”íƒ€ë°ì´í„°
  source: "naver_commerce",  // ì¶œì²˜
  source_inquiry_no: 12345,  // ì›ë³¸ ë¬¸ì˜ ë²ˆí˜¸
  created_by: "CSíŒ€",
  reviewed_at: ISODate("2025-10-01T20:00:00Z"),
  created_at: ISODate("2025-10-01T19:00:00Z"),
  updated_at: ISODate("2025-10-01T20:00:00Z")
}
```

**ì¸ë±ìŠ¤**:
```javascript
db.faqs.createIndex({ faq_id: 1 }, { unique: true })
db.faqs.createIndex({ category: 1 })
db.faqs.createIndex({ keywords: 1 })
db.faqs.createIndex({ related_products: 1 })
db.faqs.createIndex({ complexity_score: 1 })
```

### customers ì»¬ë ‰ì…˜

```javascript
{
  _id: ObjectId("..."),
  customer_id: "CUST-001",
  customer_name: "í™ê¸¸ë™",
  email: "hong@example.com",
  
  // êµ¬ë§¤ ì´ë ¥
  purchase_history: [
    {
      order_id: "ORDER-001",
      product_id: "KB-K10-PRO-001",
      purchase_date: ISODate("2024-12-01")
    }
  ],
  
  // ë¬¸ì˜ ì´ë ¥
  inquiry_history: [
    {
      inquiry_no: 12345,
      inquiry_date: ISODate("2025-01-15"),
      category: "ë°°ì†¡"
    }
  ],
  
  created_at: ISODate("2024-12-01"),
  updated_at: ISODate("2025-01-15")
}
```

### logs ì»¬ë ‰ì…˜

```javascript
// 2025-10-01 22:30, Claude ì‘ì„±
// AI ì—ì´ì „íŠ¸ ì‹¤í–‰ ë¡œê·¸
{
  _id: ObjectId("..."),
  log_type: "answer_generation",  // ë¡œê·¸ ìœ í˜•
  
  // ìš”ì²­ ì •ë³´
  inquiry_no: 12345,
  question: "K10 Pro ë°°í„°ë¦¬ ìˆ˜ëª…ì€?",
  
  // ì²˜ë¦¬ ì •ë³´
  vector_search_results: [...],  // ë²¡í„° ê²€ìƒ‰ ê²°ê³¼
  confidence_score: 0.85,        // ì‹ ë¢°ë„ ì ìˆ˜
  answer_generated: true,        // ë‹µë³€ ìƒì„± ì—¬ë¶€
  
  // ì„±ëŠ¥ ë©”íŠ¸ë¦­
  processing_time_ms: 2500,
  api_calls: {
    weaviate: 1,
    mongodb: 2,
    claude: 1
  },
  
  // ë©”íƒ€ë°ì´í„°
  timestamp: ISODate("2025-10-01T22:30:00Z"),
  version: "1.0"
}
```

---

## Weaviate í´ë˜ìŠ¤

### FAQClass (Phase 3ì—ì„œ êµ¬í˜„)

```python
# 2025-10-01 22:30, Claude ì‘ì„±
# Weaviate FAQ í´ë˜ìŠ¤ ìŠ¤í‚¤ë§ˆ
{
    "class": "FAQ",
    "description": "FAQ ì§ˆë¬¸-ë‹µë³€ ìŒì˜ ë²¡í„° í‘œí˜„",
    "vectorizer": "none",  # Sentence-BERTë¡œ ì§ì ‘ ìƒì„±
    "properties": [
        {
            "name": "faq_id",
            "dataType": ["string"],
            "description": "MongoDB FAQ ID"
        },
        {
            "name": "question",
            "dataType": ["text"],
            "description": "FAQ ì§ˆë¬¸"
        },
        {
            "name": "answer",
            "dataType": ["text"],
            "description": "FAQ ë‹µë³€"
        },
        {
            "name": "category",
            "dataType": ["string"],
            "description": "FAQ ì¹´í…Œê³ ë¦¬"
        },
        {
            "name": "keywords",
            "dataType": ["string[]"],
            "description": "í‚¤ì›Œë“œ ë°°ì—´"
        },
        {
            "name": "related_products",
            "dataType": ["string[]"],
            "description": "ê´€ë ¨ ì œí’ˆ ID ë°°ì—´"
        },
        {
            "name": "complexity_score",
            "dataType": ["number"],
            "description": "ë³µì¡ë„ ì ìˆ˜ (0.0~1.0)"
        }
    ],
    "vectorIndexConfig": {
        "distance": "cosine",  # ì½”ì‚¬ì¸ ìœ ì‚¬ë„
        "ef": 200,             # ê²€ìƒ‰ ì •í™•ë„
        "efConstruction": 128,  # ì¸ë±ìŠ¤ êµ¬ì¶• í’ˆì§ˆ
        "maxConnections": 64    # HNSW ê·¸ë˜í”„ ì—°ê²°
    }
}
```

### í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ ì „ëµ

```python
# 2025-10-01 22:30, Claude ì‘ì„±
# Weaviate í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ ì¿¼ë¦¬ ì˜ˆì‹œ
def hybrid_search(question_embedding, keywords, category=None):
    """
    ì˜ë¯¸ ê²€ìƒ‰ + í‚¤ì›Œë“œ í•„í„°ë§ ì¡°í•©
    
    Args:
        question_embedding: Sentence-BERT ì„ë² ë”© ë²¡í„°
        keywords: ì¶”ì¶œëœ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸
        category: ì¹´í…Œê³ ë¦¬ í•„í„° (ì„ íƒ)
    """
    query = {
        "vector": question_embedding,
        "alpha": 0.7,  # 0.7 = ì˜ë¯¸ ê²€ìƒ‰ 70% + í‚¤ì›Œë“œ 30%
        "limit": 10
    }
    
    # í‚¤ì›Œë“œ í•„í„° ì¶”ê°€
    if keywords:
        query["where"] = {
            "operator": "Or",
            "operands": [
                {"path": ["keywords"], "operator": "ContainsAny", "valueString": keywords}
            ]
        }
    
    # ì¹´í…Œê³ ë¦¬ í•„í„° ì¶”ê°€
    if category:
        query["where"]["operands"].append(
            {"path": ["category"], "operator": "Equal", "valueString": category}
        )
    
    return query
```

---

## ì¸ë±ìŠ¤ ì „ëµ

### MongoDB ì¸ë±ìŠ¤ ì„¤ê³„ ì›ì¹™

**1. ìì£¼ ì¡°íšŒë˜ëŠ” í•„ë“œì— ì¸ë±ìŠ¤ ìƒì„±**
- product_id, faq_id (ìœ ì¼ ì¸ë±ìŠ¤)
- category, keywords (ë‹¤ì¤‘ ì¸ë±ìŠ¤)

**2. ë³µí•© ì¸ë±ìŠ¤ í™œìš©**
```javascript
// ì¹´í…Œê³ ë¦¬ + ë³µì¡ë„ ì ìˆ˜ ë³µí•© ì¸ë±ìŠ¤
db.faqs.createIndex({ category: 1, complexity_score: 1 })

// ì œí’ˆ + ë‹¨ì¢… ì—¬ë¶€ ë³µí•© ì¸ë±ìŠ¤
db.products.createIndex({ product_id: 1, discontinued: 1 })
```

**3. í…ìŠ¤íŠ¸ ê²€ìƒ‰ ì¸ë±ìŠ¤**
```javascript
// FAQ ì „ë¬¸ ê²€ìƒ‰
db.faqs.createIndex(
  { question: "text", answer: "text" },
  { default_language: "korean" }
)
```

### Weaviate HNSW ì„¤ì •

**ë§¤ê°œë³€ìˆ˜ ì„¤ëª…**:
- `ef` (200): ê²€ìƒ‰ ì‹œ íƒìƒ‰í•  ì´ì›ƒ ìˆ˜ (ë†’ì„ìˆ˜ë¡ ì •í™•í•˜ì§€ë§Œ ëŠë¦¼)
- `efConstruction` (128): ì¸ë±ìŠ¤ êµ¬ì¶• ì‹œ í’ˆì§ˆ (ë†’ì„ìˆ˜ë¡ ê³ í’ˆì§ˆ)
- `maxConnections` (64): ê° ë…¸ë“œì˜ ìµœëŒ€ ì—°ê²° ìˆ˜ (ê·¸ë˜í”„ ë°€ë„)

**ì„±ëŠ¥ ì˜ˆìƒ**:
- FAQ 1,000ê°œ: ê²€ìƒ‰ ì‹œê°„ ~50ms
- FAQ 10,000ê°œ: ê²€ìƒ‰ ì‹œê°„ ~100ms
- FAQ 100,000ê°œ: ê²€ìƒ‰ ì‹œê°„ ~200ms

---

## ë°ì´í„° íë¦„

### ì „ì²´ íŒŒì´í”„ë¼ì¸

```
1. ë„¤ì´ë²„ API (Spring Boot)
   â†“
2. MySQL customer_inquiry (ì›ë³¸ ë°ì´í„°)
   â†“
3. Python: MySQL â†’ Google Sheets (CS ê²€ìˆ˜ìš©)
   â†“
4. CS íŒ€: Google Sheetsì—ì„œ ë‹µë³€ ì‘ì„±
   â†“
5. Python: Google Sheets â†’ MongoDB faqs (ê²€ìˆ˜ ì™„ë£Œ)
   â†“
6. Python: MongoDB faqs â†’ Weaviate (ì„ë² ë”© ìƒì„±)
   â†“
7. AI ì—ì´ì „íŠ¸: Weaviate ê²€ìƒ‰ + MongoDB ì¡°íšŒ + Claude ë‹µë³€
```

### Phase 3ì—ì„œ êµ¬í˜„í•  ì‘ì—…

1. **MongoDB ë°ì´í„° ì„í¬íŠ¸**
   - ì œí’ˆ 160ê°œ JSON â†’ MongoDB products
   - ì¸ë±ìŠ¤ ìƒì„±

2. **FAQ ì„ë² ë”© ìƒì„±**
   - MongoDB faqs â†’ Sentence-BERT
   - ì„ë² ë”© ë²¡í„° ìƒì„±

3. **Weaviate ë²¡í„° ì—…ë¡œë“œ**
   - FAQ í´ë˜ìŠ¤ ìƒì„±
   - ì„ë² ë”© ë²¡í„° + ë©”íƒ€ë°ì´í„° ì—…ë¡œë“œ

4. **í†µí•© í…ŒìŠ¤íŠ¸**
   - í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ ì •í™•ë„ í…ŒìŠ¤íŠ¸
   - ì‘ë‹µ ì‹œê°„ ì¸¡ì • (~50ms ëª©í‘œ)

---

## ë°ì´í„° ì˜ˆì‹œ

### ì‹¤ì œ ì œí’ˆ ë°ì´í„° (products_keychron.csvì—ì„œ)

```json
{
  "product_id": "KB-K10-PRO-001",
  "product_name": "Keychron K10 Pro QMK/VIA Wireless Mechanical Keyboard",
  "price": 159000,
  "keyboard_layout": "í’€ë°°ì—´ (100%)",
  "switch_options": ["Gateron Brown", "Red", "Blue", "Yellow"],
  "connection_method": "ìœ ì„ /ë¬´ì„ /ë¸”ë£¨íˆ¬ìŠ¤",
  "battery_capacity": "4000mAh",
  "bluetooth_runtime": "ìµœëŒ€ 200ì‹œê°„",
  "hot_swap_socket": true,
  "support_platforms": "Mac/Windows/Linux"
}
```

### ì‹¤ì œ FAQ ë°ì´í„° (100ê±´ ìˆ˜ì§‘ ì™„ë£Œ)

```json
{
  "faq_id": "FAQ-001",
  "question": "K10 ProëŠ” Macì—ì„œ Fn í‚¤ ê¸°ëŠ¥ì´ ì‘ë™í•˜ë‚˜ìš”?",
  "answer": "ë„¤, Macì—ì„œ ì™„ë²½í•˜ê²Œ ì‘ë™í•©ë‹ˆë‹¤. Mac ëª¨ë“œë¡œ ì „í™˜í•˜ë©´ Fn í‚¤ê°€ Mac ì „ìš© ê¸°ëŠ¥í‚¤ë¡œ ë§¤í•‘ë©ë‹ˆë‹¤.",
  "category": "í˜¸í™˜ì„±",
  "keywords": ["Mac", "Fn í‚¤", "K10 Pro", "í˜¸í™˜ì„±"],
  "related_products": ["KB-K10-PRO-001"],
  "complexity_score": 0.2,
  "source": "naver_commerce",
  "source_inquiry_no": 12345
}
```

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ì‘ì„±ì¼**: 2025-10-01  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-01 22:30  
**ë‹¤ìŒ ì—…ë°ì´íŠ¸**: Phase 3 ì‹œì‘ ì‹œ (ì‹¤ì œ ë°ì´í„° ì„í¬íŠ¸ ì™„ë£Œ í›„)
